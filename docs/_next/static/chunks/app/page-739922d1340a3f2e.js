(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{6601:function(){},9214:function(){},2215:function(e,n,t){Promise.resolve().then(t.t.bind(t,8518,23)),Promise.resolve().then(t.bind(t,8407))},8407:function(e,n,t){"use strict";t.d(n,{default:function(){return h}});var o=t(7437),i=t(7797),a=t(8703),l=t(7449),s=t.n(l),r=t(2265);t(26);var c=t(9109);let d=async(e,n)=>{let t=JSON.stringify({domain:{chainId:n,name:"Ether Mail",verifyingContract:"0xCcCCccccCCCCcCCCCCCcCcCccCcCCCcCcccccccC",version:"1"},message:{contents:"Hello, Bob!",attachedMoneyInEth:4.2,from:{name:"Cow",wallets:["0xCD2a3d9F938E13CD947Ec05AbC7FE734Df8DD826","0xDeaDbeefdEAdbeefdEadbEEFdeadbeEFdEaDbeeF"]},to:[{name:"Bob",wallets:["0xbBbBBBBbbBBBbbbBbbBbbbbBBbBbbbbBbBbbBBbB","0xB0BdaBea57B0BDABeA57b0bdABEA57b0BDabEa57","0xB0B0b0b0b0b0B000000000000000000000000000"]}]},primaryType:"Mail",types:{EIP712Domain:[{name:"name",type:"string"},{name:"version",type:"string"},{name:"chainId",type:"uint256"},{name:"verifyingContract",type:"address"}],Group:[{name:"name",type:"string"},{name:"members",type:"Person[]"}],Mail:[{name:"from",type:"Person"},{name:"to",type:"Person[]"},{name:"contents",type:"string"}],Person:[{name:"name",type:"string"},{name:"wallets",type:"address[]"}]}}),o=null==e?void 0:e.getSelectedAddress();console.debug("sign from: ".concat(o));try{if(!o){alert("Invalid account -- please connect using eth_requestAccounts first");return}let n=[o,t],i="eth_signTypedData_v4";return console.debug("ethRequest ".concat(i),JSON.stringify(n,null,4)),console.debug("sign params",n),await (null==e?void 0:e.request({method:i,params:n}))}catch(e){console.log(e)}},u=async e=>{try{var n;let t=e.getSelectedAddress(),o="0x"+c.Buffer.from("Hello World from the NextJS dapp!","utf8").toString("hex"),i=await (null===(n=window.ethereum)||void 0===n?void 0:n.request({method:"personal_sign",params:[o,t,"Example password"]}));return console.log("sign: ".concat(i)),i}catch(e){console.log(e)}};var m=t(5566);function h(){var e,n,t,l;let[c,h]=(0,r.useState)(),[g,v]=(0,r.useState)(""),[p,b]=(0,r.useState)(""),[w,C]=(0,r.useState)(""),[f,y]=(0,r.useState)(!1),[x,E]=(0,r.useState)(),[S,A]=(0,r.useState)(),[j,B]=(0,r.useState)("en"),[_,k]=(0,r.useState)(""),N=null!==(t=null==c?void 0:c.availableLanguages)&&void 0!==t?t:["en"],I=async e=>{window.location.reload()};(0,r.useEffect)(()=>{(async()=>{let e=new i.MetaMaskSDK({useDeeplink:!1,communicationServerUrl:m.env.NEXT_PUBLIC_COMM_SERVER_URL,checkInstallationImmediately:!1,i18nOptions:{enabled:!0},dappMetadata:{name:"NEXTJS demo",url:"https://localhost:3000"},logging:{developerMode:!1},storage:{enabled:!0}});await e.init(),h(e)})()},[]),(0,r.useEffect)(()=>{var e,n,t,o,i,l,s,r;if(!c||!S)return;console.debug("App::useEffect setup active provider listeners"),(null===(e=window.ethereum)||void 0===e?void 0:e.getSelectedAddress())?(console.debug("App::useEffect setting account from window.ethereum "),b(null!==(r=null===(s=window.ethereum)||void 0===s?void 0:s.getSelectedAddress())&&void 0!==r?r:""),y(!0)):y(!1);let d=e=>{console.log("App::useEfect on 'chainChanged'",e),v(e),y(!0)},u=()=>{var e,n,t,o;console.debug("App::useEffect on _initialized"),y(!0),(null===(e=window.ethereum)||void 0===e?void 0:e.getSelectedAddress())&&b(null!==(o=null===(t=window.ethereum)||void 0===t?void 0:t.getSelectedAddress())&&void 0!==o?o:""),(null===(n=window.ethereum)||void 0===n?void 0:n.getChainId())&&v(window.ethereum.getChainId())},m=e=>{console.log("App::useEfect on 'accountsChanged'",e),b(null==e?void 0:e[0]),y(!0)},h=e=>{console.log("App::useEfect on 'connect'",e),y(!0),v(e.chainId)},g=e=>{console.log("App::useEfect on 'disconnect'",e),y(!1),v("")},p=e=>{console.debug("sdk connection_status",e),E(e)};return null===(n=window.ethereum)||void 0===n||n.on("chainChanged",d),null===(t=window.ethereum)||void 0===t||t.on("_initialized",u),null===(o=window.ethereum)||void 0===o||o.on("accountsChanged",m),null===(i=window.ethereum)||void 0===i||i.on("connect",h),null===(l=window.ethereum)||void 0===l||l.on("disconnect",g),c.on(a.tw.SERVICE_STATUS,p),()=>{var e,n,t,o,i;console.debug("App::useEffect cleanup activeprovider events"),null===(e=window.ethereum)||void 0===e||e.removeListener("chainChanged",d),null===(n=window.ethereum)||void 0===n||n.removeListener("_initialized",u),null===(t=window.ethereum)||void 0===t||t.removeListener("accountsChanged",m),null===(o=window.ethereum)||void 0===o||o.removeListener("connect",h),null===(i=window.ethereum)||void 0===i||i.removeListener("disconnect",g),c.removeListener(a.tw.SERVICE_STATUS,p)}},[S]),(0,r.useEffect)(()=>{if(!(null==c?void 0:c.isInitialized()))return;let e=e=>{var n;(null==e?void 0:null===(n=e[0])||void 0===n?void 0:n.startsWith("0x"))?(y(!0),b(null==e?void 0:e[0])):(y(!1),b("")),A(c.getProvider()),k("provider"+c.getProvider())};return c.on(a.tw.PROVIDER_UPDATE,e),()=>{c.removeListener(a.tw.PROVIDER_UPDATE,e)}},[c]);let D=()=>{if(!window.ethereum)throw Error("invalid ethereum provider");window.ethereum.request({method:"eth_requestAccounts",params:[]}).then(e=>{e&&(console.debug("connect:: accounts result",e),b(e[0]),y(!0))}).catch(e=>console.log("request accounts ERR",e))},P=async()=>{try{var e,n,t,o;let i=await (null==c?void 0:c.connectAndSign({msg:"Connect + Sign message"}));C(i),b(null!==(t=null===(e=window.ethereum)||void 0===e?void 0:e.getSelectedAddress())&&void 0!==t?t:""),y(!0),v(null!==(o=null===(n=window.ethereum)||void 0===n?void 0:n.getChainId())&&void 0!==o?o:"")}catch(e){console.warn("failed to connect..",e)}},R=async()=>{if(!S||!S.getChainId()){C("invalid ethereum provider");return}C(await d(S,S.getChainId()))},T=async()=>{if(!S){C("invalid ethereum provider");return}C(await u(S))},M=async()=>{let e={to:"0x0000000000000000000000000000000000000000",from:null==S?void 0:S.getSelectedAddress(),value:"0x5AF3107A4000"};try{let n=await (null==S?void 0:S.request({method:"eth_sendTransaction",params:[e]}));C(n)}catch(e){console.log(e)}},O=async e=>{console.debug("switching to network chainId=".concat(e));try{let n=await (null==S?void 0:S.request({method:"wallet_switchEthereumChain",params:[{chainId:e}]}));console.debug("response",n)}catch(e){console.error(e)}},q=async()=>{if(!(null==c?void 0:c.hasReadOnlyRPCCalls())&&void 0===window.ethereum){C("readOnlyCalls are not set and provider is not set. Please set your infuraAPIKey in the SDK Options");return}try{var e;let n=await (null===(e=window.ethereum)||void 0===e?void 0:e.request({method:"eth_blockNumber",params:[]}));console.log("got blockNumber",n);let t=c.hasReadOnlyRPCCalls()?"infura":"MetaMask provider";C("(".concat(t,") ").concat(n))}catch(e){console.log("error getting the blockNumber",e),C("error getting the blockNumber")}};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(s(),{children:[(0,o.jsx)("title",{children:"Create Next App"}),(0,o.jsx)("meta",{name:"description",content:"Generated by create next app"}),(0,o.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),(0,o.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,o.jsxs)("main",{style:{textAlign:"center"},children:[(0,o.jsx)("h1",{children:"NextJS Example"}),(0,o.jsxs)("div",{className:"language-dropdown",children:[(0,o.jsx)("label",{htmlFor:"language-select",children:"Language: "}),(0,o.jsx)("select",{id:"language-select",value:j,onChange:e=>{B(e.target.value),I(e.target.value).then(()=>{console.debug("language changed to ".concat(e.target.value))})},children:N.map(e=>(0,o.jsx)("option",{value:e,children:e},e))})]}),(0,o.jsxs)("div",{children:["log: ",_]}),(0,o.jsx)("div",{className:"info-section",children:(0,o.jsxs)(o.Fragment,{children:["Connected chain: ".concat(g),(0,o.jsx)("p",{}),"Connected account: ".concat(p),(0,o.jsx)("p",{}),"Response: ".concat(w),(0,o.jsx)("p",{}),"Connected: ".concat(f),(null==x?void 0:x.connectionStatus)===a.QK.WAITING&&(0,o.jsx)("div",{children:"Waiting for Metamask to link the connection..."}),(0,o.jsxs)("p",{children:["ChannelId: ",null==x?void 0:null===(e=x.channelConfig)||void 0===e?void 0:e.channelId]}),(0,o.jsx)("p",{children:"Expiration: ".concat(null!==(l=null==x?void 0:null===(n=x.channelConfig)||void 0===n?void 0:n.validUntil)&&void 0!==l?l:"")})]})}),(0,o.jsxs)("div",{style:{textAlign:"center"},children:[f?(0,o.jsxs)("div",{children:[(0,o.jsx)("button",{className:"button-normal",style:{padding:10,margin:10},onClick:D,children:"Request Accounts"}),(0,o.jsx)("button",{className:"button-normal",style:{padding:10,margin:10},onClick:R,children:"eth_signTypedData_v4"}),(0,o.jsx)("button",{className:"button-normal",style:{padding:10,margin:10},onClick:T,children:"personal_sign"}),(0,o.jsx)("button",{className:"button-normal",style:{padding:10,margin:10},onClick:M,children:"Send Transaction"}),(null==S?void 0:S.getChainId())==="0x1"?(0,o.jsx)("button",{className:"button-normal",style:{padding:10,margin:10},onClick:()=>O("0x5"),children:"Switch to Goerli"}):(0,o.jsx)("button",{className:"button-normal",style:{padding:10,margin:10},onClick:()=>O("0x1"),children:"Switch to Mainnet"}),(0,o.jsx)("button",{className:"button-normal",style:{padding:10,margin:10},onClick:()=>{if(!S)throw Error("invalid ethereum provider");S.request({method:"wallet_addEthereumChain",params:[{chainId:"0x89",chainName:"Polygon",blockExplorerUrls:["https://polygonscan.com"],nativeCurrency:{symbol:"MATIC",decimals:18},rpcUrls:["https://polygon-rpc.com/"]}]}).then(e=>console.log("add",e)).catch(e=>console.log("ADD ERR",e))},children:"Add Polygon"}),(0,o.jsx)("button",{className:"button-normal",style:{padding:10,margin:10},onClick:()=>O("0x89"),children:"Switch to Polygon"}),(0,o.jsx)("button",{className:"button-normal",style:{padding:10,margin:10},onClick:q,children:"readOnlyCalls"})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("button",{className:"button-normal",style:{padding:10,margin:10},onClick:D,children:"Connect"}),(0,o.jsx)("button",{className:"button-normal",style:{padding:10,margin:10},onClick:P,children:"Connect w/ Sign"})]}),(0,o.jsx)("button",{className:"button-danger",style:{padding:10,margin:10,backgroundColor:"red"},onClick:()=>{null==c||c.terminate(),v(""),b(""),C("")},children:"Terminate"})]})]})]})}},26:function(){},8518:function(e){e.exports={main:"page_main__nw1Wk"}}},function(e){e.O(0,[600,218,497,49,971,23,744],function(){return e(e.s=2215)}),_N_E=e.O()}]);